
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Dimensionality Reduction &amp; Clustering &#8212; Neuroscience in the Age of Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter16/DimensionalityReduction';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Brain Observatory: What are those cells doing?" href="../Chapter09/NeuralActivity_2pImaging_AllenBrainObservatory.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/brainz.jpeg" class="logo__image only-light" alt="Neuroscience in the Age of Data Science - Home"/>
    <script>document.write(`<img src="../_static/brainz.jpeg" class="logo__image only-dark" alt="Neuroscience in the Age of Data Science - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    <no title>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">DATA SCIENCE IN PYTHON</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chapter03/NumPy.html">NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter03/Pandas.html">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter03/SciPy.html">SciPy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FINDING &amp; EXPLORING NEURAL DATA</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter04/FindingData.html">Finding Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter05/DataExploration_BrainSize.html">Exploring the Data</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">KINDS OF NEURAL DATA</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chapter09/NeuralActivity_2pImaging_AllenBrainObservatory.html">Brain Observatory: <em>What are those cells doing?</em></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">APPROACHES TO WORKING WITH BIG DATA</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Dimensionality Reduction &amp; Clustering</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/NeuralDataScience/NeuralDataScience.github.io/blob/master/Chapter16/DimensionalityReduction.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapter16/DimensionalityReduction.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Dimensionality Reduction & Clustering</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#by-the-end-of-this-notebook-you-ll-be-able-to">By the end of this notebook, you’ll be able to:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-create-a-dataset-of-100-neurons-with-eight-different-features">Part 1: Create a dataset of 100 neurons with eight different features.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-perform-pca-manually">Part 2. Perform PCA, manually.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-covariance-matrix">1. Compute the covariance matrix.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-eigenvectors-and-extract-the-factors-by-rotation">2. Calculate the eigenvectors and extract the factors by rotation.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-the-number-of-factors">3. Determine the number of factors.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-meaning-of-factors">3. Interpreting the meaning of factors.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#determining-the-factor-values-of-the-original-variables">4. Determining the factor values of the original variables</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-perform-pca-the-straightforward-way">Step 3. Perform PCA, the straightforward way.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sidenote-what-if-we-wanted-to-add-another-column-to-our-dataframe-with-a-category-we-d-try-to-cluster-with">Sidenote: What if we wanted to add another column to our dataframe, with a category we’d try to cluster with?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-perform-pca-on-real-electrophysiology-data">Step 4. Perform PCA on real electrophysiology data</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="dimensionality-reduction-clustering">
<h1>Dimensionality Reduction &amp; Clustering<a class="headerlink" href="#dimensionality-reduction-clustering" title="Link to this heading">#</a></h1>
<p><strong>Dimensionality reduction</strong> is an incredibly useful tool in data science as well as neuroscience. Here, we’ll explore one main method of dimensionality reduction: <strong>Principal Components Analysis</strong>. We’ll first generate a dataset, then perform PCA step-by-step, and then learn the very simple commands to do this in Python. Lastly, we’ll use <em>k</em>-means clustering to find clusters in the two-dimensional PCA data.</p>
<section id="by-the-end-of-this-notebook-you-ll-be-able-to">
<h2>By the end of this notebook, you’ll be able to:<a class="headerlink" href="#by-the-end-of-this-notebook-you-ll-be-able-to" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Run PCA on high dimensional data, including electrophysiology time series</p></li>
<li><p>Use <em>k</em>-means clustering to find clusters in your data</p></li>
<li><p>Plot the results of your dimensionality reduction and clustering, coloring each point by either a known feature or by a cluster assignment</p></li>
</ul>
</section>
<section id="about-this-notebook">
<h2>About this notebook<a class="headerlink" href="#about-this-notebook" title="Link to this heading">#</a></h2>
<p>The examples here are derived from Pascal Wallisch’s <em>Neural Data Science</em> (Chapter 8), and Jake VanderPlaas’s <em>Neural Data Science Handbook</em>. Inspiration for the exercises in Step 4 are from <a class="reference external" href="https://github.com/marius10p/NeuralDataScienceCSHL2019/blob/master/ByronYuExercises/exercises.pdf">this notebook</a> from Byron Yu, featuring data from Krisha Shenoy.</p>
<hr></section>
<section id="part-1-create-a-dataset-of-100-neurons-with-eight-different-features">
<h2>Part 1: Create a dataset of 100 neurons with eight different features.<a class="headerlink" href="#part-1-create-a-dataset-of-100-neurons-with-eight-different-features" title="Link to this heading">#</a></h2>
<p>Here, we will simulate a dataset with eight different features. First, we’ll decide on the ‘prototype’ of six different cells, for eight different features: response latency, somatic volume, cortical depth, maximum firing rate, spontaneous firing rate, spike width, axon length, and dendritic arborization area.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import our necessary toolboxes</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Specify fields to generate data</span>
<span class="n">generatorFields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;type_num&#39;</span><span class="p">,</span> <span class="s1">&#39;transmission&#39;</span><span class="p">,</span> <span class="s1">&#39;latMean&#39;</span><span class="p">,</span><span class="s1">&#39;latStd&#39;</span><span class="p">,</span><span class="s1">&#39;volMean&#39;</span><span class="p">,</span><span class="s1">&#39;volStd&#39;</span><span class="p">,</span> <span class="s1">&#39;depthMean&#39;</span><span class="p">,</span> \
                 <span class="s1">&#39;depthStd&#39;</span><span class="p">,</span><span class="s1">&#39;maxrateMean&#39;</span><span class="p">,</span> <span class="s1">&#39;maxrateStd&#39;</span><span class="p">,</span><span class="s1">&#39;spontMean&#39;</span><span class="p">,</span><span class="s1">&#39;spontStd&#39;</span><span class="p">,</span><span class="s1">&#39;widthMean&#39;</span><span class="p">,</span><span class="s1">&#39;widthStd&#39;</span><span class="p">,</span> \
                 <span class="s1">&#39;axonMean&#39;</span><span class="p">,</span><span class="s1">&#39;axonStd&#39;</span><span class="p">,</span><span class="s1">&#39;dendriteMean&#39;</span><span class="p">,</span><span class="s1">&#39;dendriteStd&#39;</span><span class="p">]</span>

<span class="c1"># Specify each property value</span>
<span class="n">Type1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;excitatory&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span><span class="mf">.02</span><span class="p">,</span><span class="mf">.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.05</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span><span class="mi">30</span> <span class="p">]</span> <span class="c1">#Cortical Layer 4 pyramid</span>
<span class="n">Type2</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;excitatory&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span><span class="mf">.07</span><span class="p">,</span><span class="mf">.01</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.04</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span><span class="mi">30</span> <span class="p">]</span> <span class="c1">#L2 pyramidal</span>
<span class="n">Type3</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;inhibitory&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span> <span class="mf">.95</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span><span class="mf">.001</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span><span class="mi">10</span> <span class="p">]</span> <span class="c1">#L2 inhibitory PV+</span>
<span class="n">Type4</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;inhibitory&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span><span class="mf">.3</span><span class="p">,</span><span class="mf">.005</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span><span class="mi">40</span> <span class="p">]</span> <span class="c1">#L2 inhibitory SOM+ </span>
<span class="n">Type5</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;excitatory&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mf">.35</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.35</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span><span class="mi">60</span> <span class="p">]</span> <span class="c1">#L6 excitatory pyramid</span>
<span class="n">Type6</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;inhibitory&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mf">.95</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span><span class="mf">.2</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span><span class="mf">.001</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span><span class="mi">10</span> <span class="p">]</span> <span class="c1">#L4 inhibitory FS+</span>

<span class="n">dftype</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">Type1</span><span class="p">,</span><span class="n">Type2</span><span class="p">,</span><span class="n">Type3</span><span class="p">,</span><span class="n">Type4</span><span class="p">,</span><span class="n">Type5</span><span class="p">,</span><span class="n">Type6</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="n">generatorFields</span><span class="p">)</span>
<span class="n">dftype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Import our necessary toolboxes</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;numpy&#39;
</pre></div>
</div>
</div>
</div>
<p>Now, we’ll create hundred neurons that are randomly selected from these six different cell types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cellFields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;latency&#39;</span><span class="p">,</span><span class="s1">&#39;volume&#39;</span><span class="p">,</span><span class="s1">&#39;depth&#39;</span><span class="p">,</span><span class="s1">&#39;maxrate&#39;</span><span class="p">,</span><span class="s1">&#39;spont&#39;</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">,</span><span class="s1">&#39;axon&#39;</span><span class="p">,</span><span class="s1">&#39;dendrite&#39;</span><span class="p">,</span><span class="s1">&#39;transmission&#39;</span><span class="p">]</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cellFields</span><span class="p">)</span> <span class="c1"># Inititialize our dataset</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span> <span class="c1"># For one hundred neurons</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># Randomly choose a cell type</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;transmission&#39;</span><span class="p">]</span> <span class="c1"># Excitatory or inhibitory?</span>
    <span class="n">latency</span> <span class="o">=</span> <span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;latMean&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">][</span><span class="s1">&#39;latStd&#39;</span><span class="p">]</span> <span class="c1"># Mean latency, with some jitter</span>
    <span class="n">vol</span><span class="o">=</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;volMean&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">][</span><span class="s1">&#39;volStd&#39;</span><span class="p">]</span> <span class="c1"># Mean volume, with some jitter</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;depthMean&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">][</span><span class="s1">&#39;depthStd&#39;</span><span class="p">]</span> <span class="c1"># Mean depth, with some jitter</span>
    <span class="n">maxrate</span> <span class="o">=</span> <span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;maxrateMean&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">][</span><span class="s1">&#39;maxrateStd&#39;</span><span class="p">]</span>
    <span class="n">spont</span> <span class="o">=</span> <span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;spontMean&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">][</span><span class="s1">&#39;spontStd&#39;</span><span class="p">]</span> 
    <span class="n">waveWidth</span> <span class="o">=</span> <span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;widthMean&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">][</span><span class="s1">&#39;widthStd&#39;</span><span class="p">]</span>
    <span class="n">axon</span> <span class="o">=</span> <span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;axonMean&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">][</span><span class="s1">&#39;axonStd&#39;</span><span class="p">]</span> 
    <span class="n">dendrite</span> <span class="o">=</span> <span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">,</span><span class="s1">&#39;dendriteMean&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span><span class="o">*</span><span class="n">dftype</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tt</span><span class="p">][</span><span class="s1">&#39;dendriteStd&#39;</span><span class="p">]</span>
    
    <span class="c1"># Append each simulated property to the dataset</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
    <span class="p">([[</span><span class="n">latency</span><span class="p">,</span><span class="n">vol</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">maxrate</span><span class="p">,</span><span class="n">spont</span><span class="p">,</span><span class="n">waveWidth</span><span class="p">,</span><span class="n">axon</span><span class="p">,</span><span class="n">dendrite</span><span class="p">,</span><span class="n">trans</span><span class="p">]],</span><span class="n">columns</span><span class="o">=</span><span class="n">cellFields</span><span class="p">),</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">nrows</span><span class="p">,</span><span class="n">ncolumns</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shape</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100, 9)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latency</th>
      <th>volume</th>
      <th>depth</th>
      <th>maxrate</th>
      <th>spont</th>
      <th>width</th>
      <th>axon</th>
      <th>dendrite</th>
      <th>transmission</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15.232010</td>
      <td>113.255853</td>
      <td>299.808284</td>
      <td>0.882077</td>
      <td>0.272622</td>
      <td>0.198983</td>
      <td>141.868908</td>
      <td>133.461595</td>
      <td>inhibitory</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.275057</td>
      <td>105.231552</td>
      <td>298.547427</td>
      <td>0.379106</td>
      <td>0.022283</td>
      <td>0.298038</td>
      <td>155.846848</td>
      <td>171.377303</td>
      <td>inhibitory</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14.696313</td>
      <td>108.123692</td>
      <td>310.407912</td>
      <td>1.001500</td>
      <td>0.334263</td>
      <td>0.199106</td>
      <td>161.315852</td>
      <td>137.636029</td>
      <td>inhibitory</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25.047027</td>
      <td>155.567002</td>
      <td>309.697521</td>
      <td>0.347535</td>
      <td>0.012836</td>
      <td>0.296320</td>
      <td>148.584848</td>
      <td>165.880021</td>
      <td>inhibitory</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.189341</td>
      <td>103.265886</td>
      <td>474.088843</td>
      <td>0.977470</td>
      <td>0.092420</td>
      <td>0.198617</td>
      <td>164.502471</td>
      <td>149.620023</td>
      <td>inhibitory</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s take a look at these eight different factors, and how they compare.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span> <span class="c1"># This is another plotting package, built really nicely for plotting these types of analyses!</span>

<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e6ba99b28932d9ac4f05c91e1e4ff431be833c77812e07edc324ad087cd587c4.png" src="../_images/e6ba99b28932d9ac4f05c91e1e4ff431be833c77812e07edc324ad087cd587c4.png" />
</div>
</div>
<p>Clearly, there’s a lot going on here. We’ll want to use dimensionality reduction to try to understand if we can reduce the understanding of this dataset into a couple of different factors.</p>
<p>For now, we’ll drop “transmission” from our dataframe – we don’t want to run PCA on it. Then, we’ll normalize each column of data. Normalization isn’t strictly <em>necessary</em> but it is a really useful for a dataset like this one where different variables have wildly different values (e.g., 0.5 to 300).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;transmission&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_data</span> <span class="o">-</span> <span class="n">x_data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">x_data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="c1"># x_data = pd.DataFrame(stats.zscore(x_data)) # An alternative way to normalize</span>
<span class="n">x_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latency</th>
      <th>volume</th>
      <th>depth</th>
      <th>maxrate</th>
      <th>spont</th>
      <th>width</th>
      <th>axon</th>
      <th>dendrite</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.295321</td>
      <td>-0.300568</td>
      <td>-0.799964</td>
      <td>0.659804</td>
      <td>0.750687</td>
      <td>-0.851639</td>
      <td>-0.432114</td>
      <td>-0.775085</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.182055</td>
      <td>-0.483894</td>
      <td>-0.806592</td>
      <td>-1.073217</td>
      <td>-0.893245</td>
      <td>-0.559050</td>
      <td>-0.396519</td>
      <td>0.048377</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.415368</td>
      <td>-0.417819</td>
      <td>-0.744243</td>
      <td>1.071281</td>
      <td>1.155470</td>
      <td>-0.851276</td>
      <td>-0.382592</td>
      <td>-0.684424</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.904176</td>
      <td>0.666090</td>
      <td>-0.747977</td>
      <td>-1.181997</td>
      <td>-0.955284</td>
      <td>-0.564124</td>
      <td>-0.415012</td>
      <td>-0.071014</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.753074</td>
      <td>-0.528802</td>
      <td>0.116202</td>
      <td>0.988485</td>
      <td>-0.432665</td>
      <td>-0.852720</td>
      <td>-0.374477</td>
      <td>-0.424153</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="part-2-perform-pca-manually">
<h2>Part 2. Perform PCA, manually.<a class="headerlink" href="#part-2-perform-pca-manually" title="Link to this heading">#</a></h2>
<section id="compute-the-covariance-matrix">
<h3>1. Compute the covariance matrix.<a class="headerlink" href="#compute-the-covariance-matrix" title="Link to this heading">#</a></h3>
<p>Here, we’ll calculate the <strong>covariance</strong> between the columns of our dataset. Similar to correlation, a positive covariance means these columns vary together, whereas a negative covariance means these columns vary in opposite directions.</p>
<p>For a more detailed direction of covariance and how it is computed, see <a class="reference external" href="https://youtube.com/watch?v=jcTq2PgU5Vw">this video</a> and <a class="reference external" href="https://www.youtube.com/watch?v=g-Hb26agBFg">this video</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">covDATA</span> <span class="o">=</span> <span class="n">x_data</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">covDATA</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Covariance Matrix (</span><span class="se">\u03A3</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/88ff57e3091e249c530a003fea3b47ea065e1793810d6499d04ccb7c98992335.png" src="../_images/88ff57e3091e249c530a003fea3b47ea065e1793810d6499d04ccb7c98992335.png" />
</div>
</div>
</section>
<section id="calculate-the-eigenvectors-and-extract-the-factors-by-rotation">
<h3>2. Calculate the eigenvectors and extract the factors by rotation.<a class="headerlink" href="#calculate-the-eigenvectors-and-extract-the-factors-by-rotation" title="Link to this heading">#</a></h3>
<p>Determine the eigenvectors and eigenvalues of our covariance matrix. This <strong>eigenvector decomposition</strong> tells us the dimensions that are most useful for understanding our data.</p>
<p>The <strong>eigenvectors</strong> tell us the direction we need to stretch the data, the <strong>eigenvalues</strong> tell us <em>how much</em> we are stretching the data. We’ll use a useful tool from the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.eig.html">numpy linear algebra package</a> to compute our eigenvectors and eigenvalues.</p>
<p>For a more detailed explaination of eigenvector decomposition, see <a class="reference external" href="https://www.youtube.com/watch?v=PFDu9oVAE-g">this video</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the linalg.eigh to compute the eigenvalues and eigenvectors</span>
<span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">covDATA</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">eigenvectors</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c4889560fff8ef6293356ed7badda015d173dac161885c1d41f9e91fc73b6e6c.png" src="../_images/c4889560fff8ef6293356ed7badda015d173dac161885c1d41f9e91fc73b6e6c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check that the sum of our eigenvalues is 8 (the number of variables)</span>
<span class="n">eigenSum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigenSum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.999999999999997
</pre></div>
</div>
</div>
</div>
</section>
<section id="determine-the-number-of-factors">
<h3>3. Determine the number of factors.<a class="headerlink" href="#determine-the-number-of-factors" title="Link to this heading">#</a></h3>
<p>PCA will extract as many factors as there are variables, but we’d like to know how many of these factors are useful in explaining our data.</p>
<p>There are a few different ways to do this (e.g., a Kaiser criterion), but here we’ll use a “<a class="reference external" href="https://en.wikipedia.org/wiki/Scree_plot">Scree plot</a>”, and look for an “elbow” (very scientific, I know). Factors to the left of the elbow are considered meaningful, whereas factors to the right are considered noise.</p>
<p>We will first create the pca model, and then use the <code class="docutils literal notranslate"><span class="pre">pca.fit_transform()</span></code> method to both fit the model and project our data back into the extracted components.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the PCA package</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span> <span class="c1"># Create a PCA model with 3 components</span>
<span class="n">x_data_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Below, we’ll plot our results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># Plot the expected variance as a function of the PC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1"># Plot a horizontal line at 1, the Kaiser criterion</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scree plot for 100 simulated neurons&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eigenvalue&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component #&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/070b43a8bb5ce5643b0fa00923f311fcaab47b2d7992e0caeb6cc5378a2d4014.png" src="../_images/070b43a8bb5ce5643b0fa00923f311fcaab47b2d7992e0caeb6cc5378a2d4014.png" />
</div>
</div>
<p>Another way of looking at this is by plotting the cumulative variance explained by our principle components:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a cumulative sum of the explained variance</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">.9</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scree plot of Cumulative Variance Explained&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative variance explained&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Principle Component #&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/692e42a0ad05dacfd750f787a69497101258a8f44c82e7fea283857a4ea310bf.png" src="../_images/692e42a0ad05dacfd750f787a69497101258a8f44c82e7fea283857a4ea310bf.png" />
</div>
</div>
<p>As you can see, we would need five principle components to account for more than 90% of the variance in the dataset (which would be a lot).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Another thing we can do is look at the explained variance for each PCA.</span>
<span class="n">ex_variance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">x_data_pca</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ex_variance_ratio</span> <span class="o">=</span> <span class="n">ex_variance</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ex_variance</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ex_variance_ratio</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.45081109 0.19321386 0.13344993 0.08315205 0.05271367 0.04061705
 0.02657689 0.01946545]
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpreting-the-meaning-of-factors">
<h3>3. Interpreting the meaning of factors.<a class="headerlink" href="#interpreting-the-meaning-of-factors" title="Link to this heading">#</a></h3>
<p>This part is really tricky for neural data – what counts as a <em>meaningful</em> factor for brain activity? This part is more or less easy depending on your data and how much you already know about it.</p>
<p>For spike sorting, these factors are typically something obvious like spike amplitude or spike width, but for behavioral measures or population dynamics, the meaning of factors could be less obvious. Below, we can see how much each feature contributes to the first three PCs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="s1">&#39;PC1&#39;</span><span class="p">,</span><span class="s1">&#39;PC2&#39;</span><span class="p">,</span><span class="s1">&#39;PC3&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span><span class="n">x_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">65</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/969b64c7358342ce23109eab2bb344c248e3ae5d6eaf4bfe2f417ae5e60b9330.png" src="../_images/969b64c7358342ce23109eab2bb344c248e3ae5d6eaf4bfe2f417ae5e60b9330.png" />
</div>
</div>
</section>
<section id="determining-the-factor-values-of-the-original-variables">
<h3>4. Determining the factor values of the original variables<a class="headerlink" href="#determining-the-factor-values-of-the-original-variables" title="Link to this heading">#</a></h3>
<p>Here, we’ll plot the first two dimensions of our PCA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x_data_pca</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PCA 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PCA 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/63e2d213d67aa7d25c8cf38a7aafec88b620e4cc5cf94b4bf9d81b1fde623535.png" src="../_images/63e2d213d67aa7d25c8cf38a7aafec88b620e4cc5cf94b4bf9d81b1fde623535.png" />
</div>
</div>
</section>
</section>
<section id="step-3-perform-pca-the-straightforward-way">
<h2>Step 3. Perform PCA, the straightforward way.<a class="headerlink" href="#step-3-perform-pca-the-straightforward-way" title="Link to this heading">#</a></h2>
<p>Thankfully, we don’t need to go through <em>all</em> of those steps whenever we want to perform PCA in Python. Really, it comes down to three steps:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>  <span class="c1"># 1. Choose the model class (PCA) and import that package</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>                            <span class="c1"># 2. Instantiate the model with hyperparameters</span>
<span class="n">X_2D</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>       <span class="c1"># 3. Fit the PCA model to our data and transform to two dimensions</span>
</pre></div>
</div>
</div>
</div>
<p>Below, we’ll plot our data using a useful function from seaborn, <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.lmplot.html">lmplot</a>, which will allow us to color our datapoints by another variable, here, transmission type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latency</th>
      <th>volume</th>
      <th>depth</th>
      <th>maxrate</th>
      <th>spont</th>
      <th>width</th>
      <th>axon</th>
      <th>dendrite</th>
      <th>transmission</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15.232010</td>
      <td>113.255853</td>
      <td>299.808284</td>
      <td>0.882077</td>
      <td>0.272622</td>
      <td>0.198983</td>
      <td>141.868908</td>
      <td>133.461595</td>
      <td>inhibitory</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.275057</td>
      <td>105.231552</td>
      <td>298.547427</td>
      <td>0.379106</td>
      <td>0.022283</td>
      <td>0.298038</td>
      <td>155.846848</td>
      <td>171.377303</td>
      <td>inhibitory</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14.696313</td>
      <td>108.123692</td>
      <td>310.407912</td>
      <td>1.001500</td>
      <td>0.334263</td>
      <td>0.199106</td>
      <td>161.315852</td>
      <td>137.636029</td>
      <td>inhibitory</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25.047027</td>
      <td>155.567002</td>
      <td>309.697521</td>
      <td>0.347535</td>
      <td>0.012836</td>
      <td>0.296320</td>
      <td>148.584848</td>
      <td>165.880021</td>
      <td>inhibitory</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.189341</td>
      <td>103.265886</td>
      <td>474.088843</td>
      <td>0.977470</td>
      <td>0.092420</td>
      <td>0.198617</td>
      <td>164.502471</td>
      <td>149.620023</td>
      <td>inhibitory</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;PCA1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_2D</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;PCA2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_2D</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;PCA3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_2D</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latency</th>
      <th>volume</th>
      <th>depth</th>
      <th>maxrate</th>
      <th>spont</th>
      <th>width</th>
      <th>axon</th>
      <th>dendrite</th>
      <th>transmission</th>
      <th>PCA1</th>
      <th>PCA2</th>
      <th>PCA3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15.232010</td>
      <td>113.255853</td>
      <td>299.808284</td>
      <td>0.882077</td>
      <td>0.272622</td>
      <td>0.198983</td>
      <td>141.868908</td>
      <td>133.461595</td>
      <td>inhibitory</td>
      <td>-0.960540</td>
      <td>-1.107669</td>
      <td>-0.818035</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.275057</td>
      <td>105.231552</td>
      <td>298.547427</td>
      <td>0.379106</td>
      <td>0.022283</td>
      <td>0.298038</td>
      <td>155.846848</td>
      <td>171.377303</td>
      <td>inhibitory</td>
      <td>-1.237584</td>
      <td>-0.278406</td>
      <td>1.047163</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14.696313</td>
      <td>108.123692</td>
      <td>310.407912</td>
      <td>1.001500</td>
      <td>0.334263</td>
      <td>0.199106</td>
      <td>161.315852</td>
      <td>137.636029</td>
      <td>inhibitory</td>
      <td>-0.938894</td>
      <td>-1.159347</td>
      <td>-1.378928</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25.047027</td>
      <td>155.567002</td>
      <td>309.697521</td>
      <td>0.347535</td>
      <td>0.012836</td>
      <td>0.296320</td>
      <td>148.584848</td>
      <td>165.880021</td>
      <td>inhibitory</td>
      <td>0.414342</td>
      <td>-0.470835</td>
      <td>2.068303</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.189341</td>
      <td>103.265886</td>
      <td>474.088843</td>
      <td>0.977470</td>
      <td>0.092420</td>
      <td>0.198617</td>
      <td>164.502471</td>
      <td>149.620023</td>
      <td>inhibitory</td>
      <td>-1.174234</td>
      <td>-0.437223</td>
      <td>-0.845270</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s2">&quot;PCA1&quot;</span><span class="p">,</span> <span class="s2">&quot;PCA2&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;transmission&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ashley/anaconda3/lib/python3.7/site-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</pre></div>
</div>
<img alt="../_images/22bd36392972cad47ff74c906a7d3e4fbb896fb29f566ffc69dc8bfe2a0bd28e.png" src="../_images/22bd36392972cad47ff74c906a7d3e4fbb896fb29f566ffc69dc8bfe2a0bd28e.png" />
</div>
</div>
<p>Remember the PCA didn’t have any information on whether our cells were excitatory or inhibitory, but clearly it’s picking up on features that also divide those cell types. And, it looks like excitatory and inhibitory cells actually might fall into three classes. Let’s see what happens if we use <em>k</em>-means clustering on our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">KMeans</span> <span class="c1">#Import the KMeans model</span>

<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># Set up a kmeans model with 3 clusters</span>

<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_2D</span><span class="p">)</span> <span class="c1"># Fit our two dimensional data</span>
<span class="n">y_kmeans</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_2D</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>Again, we’ll use the <code class="docutils literal notranslate"><span class="pre">sns.lmplot()</span></code> method to nicely plot our data. Here, we’ll color each point by its assigned <em>k</em>-means cluster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add our kmeans group to the data for plotting</span>
<span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;kmeans_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_kmeans</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s2">&quot;PCA1&quot;</span><span class="p">,</span> <span class="s2">&quot;PCA2&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;kmeans_group&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">centers</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ashley/anaconda3/lib/python3.7/site-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</pre></div>
</div>
<img alt="../_images/82a47216bbc73668b72895eb21de9759348368cb2b05e2a56c946756d21e5f7d.png" src="../_images/82a47216bbc73668b72895eb21de9759348368cb2b05e2a56c946756d21e5f7d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">centers</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.94079565  3.78816193 -0.6090057 ]
[-0.80785888 -0.28989969  1.83890492]
</pre></div>
</div>
</div>
</div>
<p>If we have tell <em>k</em>-means to use three clusters, it divides it up into three clusters. What happens if we tell it there are two clusters?</p>
<section id="sidenote-what-if-we-wanted-to-add-another-column-to-our-dataframe-with-a-category-we-d-try-to-cluster-with">
<h3>Sidenote: What if we wanted to add another column to our dataframe, with a category we’d try to cluster with?<a class="headerlink" href="#sidenote-what-if-we-wanted-to-add-another-column-to-our-dataframe-with-a-category-we-d-try-to-cluster-with" title="Link to this heading">#</a></h3>
<p>Let’s say we want to create a new dataframe with a categorical column for the depth of cells to our dataframe. We’d use the syntax <code class="docutils literal notranslate"><span class="pre">df['new</span> <span class="pre">column</span> <span class="pre">name']</span> <span class="pre">=</span> <span class="pre">pd.Series(index=dataset.index,dtype='int64')</span></code> to add an empty column with the same index and a specified datatype. We can then put ‘shallow’ or ‘deep’ in this column using the following syntax: <code class="docutils literal notranslate"><span class="pre">df.loc[condition,</span> <span class="pre">'new</span> <span class="pre">column</span> <span class="pre">name']</span> <span class="pre">=</span> <span class="pre">'value'</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;depthCategory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;depthCategory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;shallow&#39;</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;depthCategory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;deep&#39;</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latency</th>
      <th>volume</th>
      <th>depth</th>
      <th>maxrate</th>
      <th>spont</th>
      <th>width</th>
      <th>axon</th>
      <th>dendrite</th>
      <th>transmission</th>
      <th>PCA1</th>
      <th>PCA2</th>
      <th>PCA3</th>
      <th>kmeans_group</th>
      <th>depthCategory</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15.232010</td>
      <td>113.255853</td>
      <td>299.808284</td>
      <td>0.882077</td>
      <td>0.272622</td>
      <td>0.198983</td>
      <td>141.868908</td>
      <td>133.461595</td>
      <td>inhibitory</td>
      <td>-0.960540</td>
      <td>-1.107669</td>
      <td>-0.818035</td>
      <td>0</td>
      <td>shallow</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.275057</td>
      <td>105.231552</td>
      <td>298.547427</td>
      <td>0.379106</td>
      <td>0.022283</td>
      <td>0.298038</td>
      <td>155.846848</td>
      <td>171.377303</td>
      <td>inhibitory</td>
      <td>-1.237584</td>
      <td>-0.278406</td>
      <td>1.047163</td>
      <td>0</td>
      <td>shallow</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14.696313</td>
      <td>108.123692</td>
      <td>310.407912</td>
      <td>1.001500</td>
      <td>0.334263</td>
      <td>0.199106</td>
      <td>161.315852</td>
      <td>137.636029</td>
      <td>inhibitory</td>
      <td>-0.938894</td>
      <td>-1.159347</td>
      <td>-1.378928</td>
      <td>0</td>
      <td>shallow</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25.047027</td>
      <td>155.567002</td>
      <td>309.697521</td>
      <td>0.347535</td>
      <td>0.012836</td>
      <td>0.296320</td>
      <td>148.584848</td>
      <td>165.880021</td>
      <td>inhibitory</td>
      <td>0.414342</td>
      <td>-0.470835</td>
      <td>2.068303</td>
      <td>0</td>
      <td>shallow</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.189341</td>
      <td>103.265886</td>
      <td>474.088843</td>
      <td>0.977470</td>
      <td>0.092420</td>
      <td>0.198617</td>
      <td>164.502471</td>
      <td>149.620023</td>
      <td>inhibitory</td>
      <td>-1.174234</td>
      <td>-0.437223</td>
      <td>-0.845270</td>
      <td>0</td>
      <td>shallow</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="step-4-perform-pca-on-real-electrophysiology-data">
<h2>Step 4. Perform PCA on real electrophysiology data<a class="headerlink" href="#step-4-perform-pca-on-real-electrophysiology-data" title="Link to this heading">#</a></h2>
<p>We can also use PCA on time series data. Here, we’ll work with a sample data set (data_for_exercises.mat) which you can download from <a class="reference external" href="https://github.com/marius10p/NeuralDataScienceCSHL2019/blob/master/ByronYuExercises/data_for_exercises.mat">here</a>. This dataset contains spike counts for 97 neurons recorded using an electrode array over the dorsal premotor cortex of a monkey during a reaching task. Each row of the dataset (728) is a different trial for a different angle of reaching (8 angles total). Trials 1-91 are for reach angle 1, 92-182 for reach angle 2, etc.</p>
<p>You can read more about the experiments that created this dataset <a class="reference external" href="https://www.jneurosci.org/content/27/40/10742">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.io</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>

<span class="n">numChannels</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">matIn</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;data_for_exercises.mat&#39;</span><span class="p">)</span>
<span class="n">spike_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matIn</span><span class="p">[</span><span class="s1">&#39;Xplan&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-success">
<p><strong>Task</strong>: Take a look at the raw electrophysiology data here by setting up a plot and looping through each row of <code class="docutils literal notranslate"><span class="pre">spike_data</span></code> to add it to the plot. Add a variable <code class="docutils literal notranslate"><span class="pre">y</span></code> which increases each time you run through a loop, allowing you to stack all of these traces (instead of plotting them on top of each other).</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the raw data here</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">neuron</span> <span class="ow">in</span> <span class="n">spike_data</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spike_data</span><span class="p">[</span><span class="n">neuron</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="mi">10</span> <span class="c1"># 10 is arbitrary! This is just a way of spacing out our traces.</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a657e28eca658e54da91ff1c58621585486d7e5fe2875f3fe96fad6758fae762.png" src="../_images/a657e28eca658e54da91ff1c58621585486d7e5fe2875f3fe96fad6758fae762.png" />
</div>
</div>
<div class="alert alert-success">
<p><strong>Task</strong>: Compute the PCA for these data and plot the results (with either <code class="docutils literal notranslate"><span class="pre">plt.scatter()</span></code> or <code class="docutils literal notranslate"><span class="pre">sns.lmplot()</span></code>. For this plot, you do not need a <code class="docutils literal notranslate"><span class="pre">color</span></code> or <code class="docutils literal notranslate"><span class="pre">hue</span></code> argument.</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute your PCA here</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">spike_data</span><span class="p">)</span>
<span class="n">spike_2D</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">spike_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-success">
<p><strong>Task</strong>: As it notes above, <em>Each row of the dataset (728) is a different trial for a different angle of reaching (8 angles total). Trials 1-91 are for reach angle 1, 92-182 for reach angle 2, etc.</em> In the previous example of cell features, we colored our final PCA plot by whether the cell was excitatory or inhibitory. Here, we want to color each point on our PCA plot by the reach angle.</p>
<p>To do so, create a column in the spike_data frame called “angles”, which contains a list of angle names (can simply be 1, 2, 3, etc. Then, go back to your plot and add this as the <code class="docutils literal notranslate"><span class="pre">hue</span></code> argument.</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign the angles column here</span>
<span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">angle_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">,</span><span class="s1">&#39;8&#39;</span><span class="p">]</span>
<span class="n">angle_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">728</span><span class="p">,</span><span class="mi">91</span><span class="p">)</span>
<span class="n">angle_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">91</span><span class="p">,</span><span class="mi">729</span><span class="p">,</span><span class="mi">91</span><span class="p">)</span>

<span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">angle_start</span><span class="p">[</span><span class="n">angle</span><span class="p">],</span><span class="n">angle_end</span><span class="p">[</span><span class="n">angle</span><span class="p">]):</span>
        <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_names</span><span class="p">[</span><span class="n">angle</span><span class="p">])</span>

<span class="n">spike_data</span><span class="p">[</span><span class="s1">&#39;angles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">angles</span>

<span class="n">spike_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>88</th>
      <th>89</th>
      <th>90</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>angles</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>0</td>
      <td>2</td>
      <td>...</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>2</td>
      <td>0</td>
      <td>12</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>16</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>14</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
      <td>11</td>
      <td>0</td>
      <td>4</td>
      <td>...</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 98 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spike_data</span><span class="p">[</span><span class="s1">&#39;PC1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spike_2D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">spike_data</span><span class="p">[</span><span class="s1">&#39;PC2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spike_2D</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">spike_data</span><span class="p">[</span><span class="s1">&#39;PC3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spike_2D</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s1">&#39;PC2&#39;</span><span class="p">,</span><span class="s1">&#39;PC3&#39;</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">spike_data</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;angles&#39;</span><span class="p">,</span><span class="n">fit_reg</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ashley/anaconda3/lib/python3.7/site-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</pre></div>
</div>
<img alt="../_images/887c5be78c3d62b5365add95895c9e6abc089594367db28fd16dd89eab8f9dc5.png" src="../_images/887c5be78c3d62b5365add95895c9e6abc089594367db28fd16dd89eab8f9dc5.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapter16"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Chapter09/NeuralActivity_2pImaging_AllenBrainObservatory.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Brain Observatory: <em>What are those cells doing?</em></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#by-the-end-of-this-notebook-you-ll-be-able-to">By the end of this notebook, you’ll be able to:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-create-a-dataset-of-100-neurons-with-eight-different-features">Part 1: Create a dataset of 100 neurons with eight different features.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-perform-pca-manually">Part 2. Perform PCA, manually.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-covariance-matrix">1. Compute the covariance matrix.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-eigenvectors-and-extract-the-factors-by-rotation">2. Calculate the eigenvectors and extract the factors by rotation.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-the-number-of-factors">3. Determine the number of factors.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-meaning-of-factors">3. Interpreting the meaning of factors.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#determining-the-factor-values-of-the-original-variables">4. Determining the factor values of the original variables</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-perform-pca-the-straightforward-way">Step 3. Perform PCA, the straightforward way.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sidenote-what-if-we-wanted-to-add-another-column-to-our-dataframe-with-a-category-we-d-try-to-cluster-with">Sidenote: What if we wanted to add another column to our dataframe, with a category we’d try to cluster with?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-perform-pca-on-real-electrophysiology-data">Step 4. Perform PCA on real electrophysiology data</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ashley Juavinett & Bradley Voytek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>