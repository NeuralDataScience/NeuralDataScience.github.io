
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>3.1. Working with NWB in Python &#8212; A Hands-On Guide to Neural Data Science</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. The Allen SDK" href="../Chapter_4/The_Allen_SDK.html" />
    <link rel="prev" title="3. Neurodata Without Borders" href="Neurodata_Without_Borders.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/brainz.jpeg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">A Hands-On Guide to Neural Data Science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../landing_page.html">
   A Hands-On Guide to Neural Data Science
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_1/Neural_Data_Science.html">
   1. Neural Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2/Data_Science_In_Python.html">
   2. Data Science in Python
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="Neurodata_Without_Borders.html">
   3. Neurodata Without Borders
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3.1. Working with NWB in Python
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_4/The_Allen_SDK.html">
   4. The Allen SDK
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_5/Single-Cell_Electrophysiology.html">
   5. Single-Cell Electrophysiology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_6/Large_Scale_Electrophysiology.html">
   6. Large Scale Electrophysiology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_7/Two-photon_Calcium_Imaging_Data.html">
   7. Two-photon Calcium Imaging Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_8/Connectivity_Atlas.html">
   8. Connectivity Atlas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_9/Brain_Imaging_Data_Structures.html">
   9. Brain Imaging Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_10/Text_Analyses_of_Neuroscience_Literature.html">
   10. Text Analyses of Neuroscience Literature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_11/Approaches_to_Analyzing_Large_Datasets.html">
   11. Approaches to Analyzing Large Datasets
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Chapter_3/Working_with_NWB_format_in_Python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/NeuralDataScience/NeuralDataScience.github.io/master?urlpath=tree/Chapter_3/Working_with_NWB_format_in_Python.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/NeuralDataScience/NeuralDataScience.github.io/blob/master/Chapter_3/Working_with_NWB_format_in_Python.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-our-nwb-file">
   3.1.1. Reading our NWB file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#file-hierarchy-groups-datasets-and-attributes">
   3.1.2. File Hierarchy: Groups, Datasets, and Attributes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#possible-analyses">
   3.1.3. Possible Analyses
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="working-with-nwb-in-python">
<h1><span class="section-number">3.1. </span>Working with NWB in Python<a class="headerlink" href="#working-with-nwb-in-python" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pynwb</span> <span class="kn">import</span> <span class="n">NWBHDF5IO</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-our-nwb-file">
<h2><span class="section-number">3.1.1. </span>Reading our NWB file<a class="headerlink" href="#reading-our-nwb-file" title="Permalink to this headline">¶</a></h2>
<p>To access the data in our nwb file we must read the file. This is done in two steps:</p>
<ul class="simple">
<li><p>assign our file as an <code class="docutils literal notranslate"><span class="pre">NWBHDF5IO</span></code> object</p></li>
<li><p>read our file</p></li>
</ul>
<p>The first step is done using the <code class="docutils literal notranslate"><span class="pre">NWBHDF5IO</span></code> class to create our <code class="docutils literal notranslate"><span class="pre">NWBHDF5IO</span></code> object and map our file to HDF5 format. Once we have done this, we can use the <code class="docutils literal notranslate"><span class="pre">read()</span></code> method to return our nwb file. For more information on how to read NWB files, please visit the <em>Reading data from an NWB file</em> section from the <a href = 'https://pynwb.readthedocs.io/en/latest/tutorials/general/file.html'> NWB Basics Tutorial</a>. For more information on the <code class="docutils literal notranslate"><span class="pre">NWBHDF5IO</span></code> class, please visit the <a href = 'https://pynwb.readthedocs.io/en/latest/pynwb.html#pynwb.NWBHDF5IO'> original documentation</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first read the file </span>
<span class="n">io</span> <span class="o">=</span> <span class="n">NWBHDF5IO</span><span class="p">(</span><span class="s1">&#39;000017/sub-Cori/sub-Cori_ses-20161214T120000.nwb&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">nwb_file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nwb_file</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">UnsupportedOperation</span><span class="g g-Whitespace">                      </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">17</span><span class="n">c83d068239</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># first read the file</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">io</span> <span class="o">=</span> <span class="n">NWBHDF5IO</span><span class="p">(</span><span class="s1">&#39;000017/sub-Cori/sub-Cori_ses-20161214T120000.nwb&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">nwb_file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nwb_file</span><span class="p">))</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/hdmf/utils.py</span> in <span class="ni">func_call</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span>             <span class="k">def</span> <span class="nf">func_call</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span>                 <span class="n">pargs</span> <span class="o">=</span> <span class="n">_check_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">561</span>                 <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">pargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">562</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">563</span>             <span class="k">def</span> <span class="nf">func_call</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/pynwb/__init__.py</span> in <span class="ni">__init__</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">244</span>             <span class="k">elif</span> <span class="n">manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span>                 <span class="n">manager</span> <span class="o">=</span> <span class="n">get_manager</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">246</span>         <span class="nb">super</span><span class="p">(</span><span class="n">NWBHDF5IO</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">manager</span><span class="o">=</span><span class="n">manager</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">file_obj</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">comm</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span> 
<span class="g g-Whitespace">    </span><span class="mi">248</span>     <span class="nd">@docval</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;src_io&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">HDMFIO</span><span class="p">,</span> <span class="s1">&#39;doc&#39;</span><span class="p">:</span> <span class="s1">&#39;the HDMFIO object for reading the data to export&#39;</span><span class="p">},</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/hdmf/utils.py</span> in <span class="ni">func_call</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span>             <span class="k">def</span> <span class="nf">func_call</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span>                 <span class="n">pargs</span> <span class="o">=</span> <span class="n">_check_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">561</span>                 <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">pargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">562</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">563</span>             <span class="k">def</span> <span class="nf">func_call</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/hdmf/backends/hdf5/h5tools.py</span> in <span class="ni">__init__</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span>         <span class="k">if</span> <span class="n">file_obj</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span> <span class="ow">or</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;r+&#39;</span><span class="p">):</span>
<span class="nn">     54             msg = &quot;Unable to open file %s</span> in <span class="ni">&#39;%s&#39; mode. File does not exist.&quot; % </span><span class="nt">(path, mode)</span>
<span class="ne">---&gt; </span><span class="mi">55</span>             <span class="k">raise</span> <span class="n">UnsupportedOperation</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> 
<span class="g g-Whitespace">     </span><span class="mi">57</span>         <span class="k">if</span> <span class="n">file_obj</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;w-&#39;</span> <span class="ow">or</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">):</span>

<span class="ne">UnsupportedOperation</span>: Unable to open file 000017/sub-Cori/sub-Cori_ses-20161214T120000.nwb in &#39;r&#39; mode. File does not exist.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="file-hierarchy-groups-datasets-and-attributes">
<h2><span class="section-number">3.1.2. </span>File Hierarchy: Groups, Datasets, and Attributes<a class="headerlink" href="#file-hierarchy-groups-datasets-and-attributes" title="Permalink to this headline">¶</a></h2>
<p>The NWB file is composed of various Groups, Datasets, and Attributes. The data/datasets and cooresponding meta-data are encapsulated within these Groups. The <code class="docutils literal notranslate"><span class="pre">fields</span></code> attribute returns a dictionary contiaining the metadata of the Groups of our nwb file. The dictionary <code class="docutils literal notranslate"><span class="pre">keys</span></code> are the various Groups within the file which we will use to access our datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># nwb_file.fields</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the Groups for the nwb file </span>
<span class="n">nwb_fields</span> <span class="o">=</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">fields</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nwb_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;acquisition&#39;, &#39;analysis&#39;, &#39;scratch&#39;, &#39;stimulus&#39;, &#39;stimulus_template&#39;, &#39;processing&#39;, &#39;devices&#39;, &#39;electrode_groups&#39;, &#39;imaging_planes&#39;, &#39;icephys_electrodes&#39;, &#39;ogen_sites&#39;, &#39;intervals&#39;, &#39;lab_meta_data&#39;, &#39;session_description&#39;, &#39;identifier&#39;, &#39;session_start_time&#39;, &#39;timestamps_reference_time&#39;, &#39;file_create_date&#39;, &#39;keywords&#39;, &#39;epoch_tags&#39;, &#39;electrodes&#39;, &#39;subject&#39;, &#39;trials&#39;, &#39;units&#39;, &#39;experiment_description&#39;, &#39;lab&#39;, &#39;institution&#39;, &#39;experimenter&#39;, &#39;related_publications&#39;])
</pre></div>
</div>
</div>
</div>
<p>Each NWB file will have information on where the experiment was conducted, what lab conducted the experiment, as well as a description of the experiment. This information can be accessed using <code class="docutils literal notranslate"><span class="pre">institution</span></code>, <code class="docutils literal notranslate"><span class="pre">lab</span></code>, and <code class="docutils literal notranslate"><span class="pre">description</span></code>, attributes on our <code class="docutils literal notranslate"><span class="pre">nwb_file</span></code>, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get Meta-Data from NWB file </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The experiment within this NWB file was conducted at </span><span class="si">{}</span><span class="s1"> in the lab of </span><span class="si">{}</span><span class="s1">. The experiment is detailed as follows: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nwb_file</span><span class="o">.</span><span class="n">institution</span><span class="p">,</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">lab</span><span class="p">,</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">experiment_description</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The experiment within this NWB file was conducted at University College London in the lab of The Carandini and Harris Lab. The experiment is detailed as follows: Large-scale Neuropixels recordings across brain regions of mice during a head-fixed visual discrimination task. 
</pre></div>
</div>
</div>
</div>
<p>We can access metadata from each group in our <code class="docutils literal notranslate"><span class="pre">nwb_file</span></code> with the following syntax: <code class="docutils literal notranslate"><span class="pre">nwb_file.group</span></code>. This is no different than executing a method and/or attribute. The <code class="docutils literal notranslate"><span class="pre">acquisition</span></code> group contains datasets of acquisition data. We can look at the look at the <code class="docutils literal notranslate"><span class="pre">description</span></code> field in the metadata to understand what each dataset in the group contains.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example showing how to return meta data from groups in nwb file </span>
<span class="c1"># &#39;acquisition&#39; is the first group in our file </span>
<span class="n">nwb_file</span><span class="o">.</span><span class="n">acquisition</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;lickPiezo&#39;: lickPiezo pynwb.base.TimeSeries at 0x140437403596048
 Fields:
   comments: no comments
   conversion: 1.0
   data: &lt;HDF5 dataset &quot;data&quot;: shape (1314000,), type &quot;&lt;f8&quot;&gt;
   description: Voltage values from a thin-film piezo connected to the lick spout, so that values are proportional to deflection of the spout and licks can be detected as peaks of the signal.
   rate: 0.002000031887945625
   resolution: -1.0
   starting_time: 33.65250410481991
   starting_time_unit: seconds
   unit: V,
 &#39;wheel_position&#39;: wheel_position pynwb.base.TimeSeries at 0x140437403596176
 Fields:
   comments: The wheel has radius 31 mm and 1440 ticks per revolution, so multiply by 2*pi*r/tpr=0.135 to convert to millimeters. Positive velocity (increasing numbers) correspond to clockwise turns (if looking at the wheel from behind the mouse), i.e. turns that are in the correct direction for stimuli presented to the left. Likewise negative velocity corresponds to right choices.
   conversion: 0.135
   data: &lt;HDF5 dataset &quot;data&quot;: shape (6570000,), type &quot;&lt;f8&quot;&gt;
   description: The position reading of the rotary encoder attached to the rubber wheel that the mouse pushes left and right with his forelimbs.
   rate: 0.00040000637758912496
   resolution: -1.0
   starting_time: 33.65250410481991
   starting_time_unit: seconds
   unit: mm}
</pre></div>
</div>
</div>
</div>
<p>In this file, the acquisition group contains two different dataets, <code class="docutils literal notranslate"><span class="pre">lickPiezo</span></code> and <code class="docutils literal notranslate"><span class="pre">wheel_position</span></code>. To access the actual data array of these datasets we must first subset our dataset of interest from the group. We can then use <code class="docutils literal notranslate"><span class="pre">data[:]</span></code> to return our actual data array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># select our dataset of interest </span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s1">&#39;lickPiezo&#39;</span>
<span class="n">lickPiezo_ds</span> <span class="o">=</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">acquisition</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span>

<span class="c1"># return first 20 values in data array </span>
<span class="n">lickPiezo_data_array</span> <span class="o">=</span> <span class="n">lickPiezo_ds</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lickPiezo_data_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3.18436567 3.4575181  3.63766762 3.71285813 3.68129979 3.55107522
 3.33830297 3.06425065 2.75209663 2.42396281 2.09870512 1.7906713
 1.50938029 1.25993802 1.04387904 0.85846741 0.69874522 0.56921781
 0.46425845 0.37914098]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">processing</span></code> group in our <code class="docutils literal notranslate"><span class="pre">nwb_file</span></code> contains all of our processed data for scientific analysis. Within the procesing group there are mulitple subgroups that belong to the <code class="docutils literal notranslate"><span class="pre">behavior</span></code> module. <code class="docutils literal notranslate"><span class="pre">BehavioralEpochs</span></code>, <code class="docutils literal notranslate"><span class="pre">BehavioralEvents</span></code>, <code class="docutils literal notranslate"><span class="pre">BehavioralEvents</span></code>, and <code class="docutils literal notranslate"><span class="pre">PupilTracking</span></code> are seperate groups encapsulated within <code class="docutils literal notranslate"><span class="pre">behavior</span></code> and contain their own datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># return meta data for prcessing group</span>
<span class="n">nwb_file</span><span class="o">.</span><span class="n">processing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;behavior&#39;: behavior pynwb.base.ProcessingModule at 0x140437403596496
 Fields:
   data_interfaces: {
     BehavioralEpochs &lt;class &#39;pynwb.behavior.BehavioralEpochs&#39;&gt;,
     BehavioralEvents &lt;class &#39;pynwb.behavior.BehavioralEvents&#39;&gt;,
     BehavioralTimeSeries &lt;class &#39;pynwb.behavior.BehavioralTimeSeries&#39;&gt;,
     PupilTracking &lt;class &#39;pynwb.behavior.PupilTracking&#39;&gt;
   }
   description: behavior module}
</pre></div>
</div>
</div>
</div>
<p>If we subset <code class="docutils literal notranslate"><span class="pre">PupilTracking</span></code> from <code class="docutils literal notranslate"><span class="pre">behavior</span></code> we can see that it contains two datasets. We can do as we did before and subset our dataset of interst and return the actual data array by executing <code class="docutils literal notranslate"><span class="pre">data[:]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># assign behavior group to variable </span>
<span class="n">behavior</span> <span class="o">=</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">processing</span><span class="p">[</span><span class="s1">&#39;behavior&#39;</span><span class="p">]</span>

<span class="c1"># subset PupilTracking group from behavior group </span>
<span class="n">pupil_tracking</span> <span class="o">=</span> <span class="n">behavior</span><span class="p">[</span><span class="s1">&#39;PupilTracking&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pupil_tracking</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PupilTracking pynwb.behavior.PupilTracking at 0x140437405881424
Fields:
  time_series: {
    eye_area &lt;class &#39;pynwb.base.TimeSeries&#39;&gt;,
    eye_xy_positions &lt;class &#39;pynwb.base.TimeSeries&#39;&gt;
  }
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># subset the eye_xy_positions dataset</span>
<span class="n">eye_xy_positions</span> <span class="o">=</span> <span class="n">pupil_tracking</span><span class="p">[</span><span class="s1">&#39;eye_xy_positions&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eye_xy_positions</span><span class="p">)</span>

<span class="c1"># return firsy 10 entires in actual data array</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Eye (x,y) positions:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eye_xy_positions</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eye_xy_positions pynwb.base.TimeSeries at 0x140437405881872
Fields:
  comments: The 2D position of the center of the pupil in the video frame. This is not registered to degrees visual angle, but could be used to detect saccades or other changes in eye position.
  conversion: 1.0
  data: &lt;HDF5 dataset &quot;data&quot;: shape (267759, 2), type &quot;&lt;f8&quot;&gt;
  description: Features extracted from the video of the right eye.
  interval: 1
  resolution: -1.0
  timestamps: &lt;HDF5 dataset &quot;timestamps&quot;: shape (267759,), type &quot;&lt;f8&quot;&gt;
  timestamps_unit: seconds
  unit: arb. unit


 Eye (x,y) positions:
[[1.56599408 0.06802196]
 [1.58213078 0.05515582]
 [1.5796662  0.14542675]
 [1.57286532 0.13382707]
 [1.57185696 0.01200337]
 [1.58985626 0.08226199]
 [1.62204413 0.26782588]
 [1.59213104 0.13432399]
 [1.6127692  0.33010592]
 [1.63706748 0.28426869]]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">intervals</span></code> Group contains datasets from trials of our experiment, sub-experiments that were conducted, and/or epochs. For the example below, we will look into the <code class="docutils literal notranslate"><span class="pre">trials</span></code> dataset. You can return the <code class="docutils literal notranslate"><span class="pre">trials</span></code> data as a dataframe by using the <code class="docutils literal notranslate"><span class="pre">to_dataframe</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the group of interest </span>
<span class="n">intervals</span> <span class="o">=</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">intervals</span>

<span class="c1"># Subset the dataset from the group and assign it as a dataframe</span>
<span class="n">interval_trials_df</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">[</span><span class="s1">&#39;trials&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">interval_trials_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>start_time</th>
      <th>stop_time</th>
      <th>included</th>
      <th>go_cue</th>
      <th>visual_stimulus_time</th>
      <th>visual_stimulus_left_contrast</th>
      <th>visual_stimulus_right_contrast</th>
      <th>response_time</th>
      <th>response_choice</th>
      <th>feedback_time</th>
      <th>feedback_type</th>
      <th>rep_num</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>62.900284</td>
      <td>67.423484</td>
      <td>True</td>
      <td>66.296625</td>
      <td>65.269408</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>66.419612</td>
      <td>1.0</td>
      <td>66.456227</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>68.420838</td>
      <td>73.604476</td>
      <td>True</td>
      <td>72.077117</td>
      <td>71.202703</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>72.602206</td>
      <td>-1.0</td>
      <td>72.640326</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>74.602902</td>
      <td>78.006757</td>
      <td>True</td>
      <td>76.877593</td>
      <td>76.052380</td>
      <td>1.0</td>
      <td>0.5</td>
      <td>77.001671</td>
      <td>1.0</td>
      <td>77.038396</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>79.003653</td>
      <td>84.506778</td>
      <td>True</td>
      <td>81.996875</td>
      <td>81.235263</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>83.502065</td>
      <td>0.0</td>
      <td>83.531699</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>85.501795</td>
      <td>88.621336</td>
      <td>True</td>
      <td>87.462962</td>
      <td>86.800952</td>
      <td>0.5</td>
      <td>1.0</td>
      <td>87.617727</td>
      <td>1.0</td>
      <td>87.628565</td>
      <td>-1</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">description</span></code> attribute provides a short description on each column of the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">intervals</span><span class="p">[</span><span class="s1">&#39;trials&#39;</span><span class="p">][</span><span class="s1">&#39;response_choice&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Enumerated type. The response registered at the end of the trial, which determines the feedback according to the contrast condition. Note that in a small percentage of cases (~4%, see manuscript Methods) the initial wheel turn was in the opposite direction. -1 for Right choice (i.e. correct when stimuli are on the right); +1 for left choice; 0 for Nogo choice.
</pre></div>
</div>
</div>
</div>
<p>For more information on all the different Groups and hierarchal structure of an NWB file, please visit the <a href = 'https://nwb-schema.readthedocs.io/en/latest/format.html#nwb-n-file'> NWB:N file section</a> of the NWB Format documentation. For a list of all the attributes and methods for a <code class="docutils literal notranslate"><span class="pre">pynwb.file.NWBfile</span></code> obeject, please visit the <a href = 'https://pynwb.readthedocs.io/en/stable/pynwb.file.html'> module documentation</a>.</p>
</div>
<div class="section" id="possible-analyses">
<h2><span class="section-number">3.1.3. </span>Possible Analyses<a class="headerlink" href="#possible-analyses" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># nwb_file</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># test cell </span>
<span class="n">nwb_file</span><span class="o">.</span><span class="n">session_description</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Neuropixels recording during visual discrimination in awake mice.&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># test cell</span>
<span class="n">stimulus_dict</span> <span class="o">=</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">stimulus</span> 
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">stimulus_dict</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">stimulus_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>passive_beeps:
Auditory tones of the same frequency as the auditory tone cue in the task


passive_click_times:
Opening of the reward valve, but with a clamp in place such that no water flows. Therefore the auditory sound of the valve is heard, but no water reward is obtained.


passive_left_contrast:
Gratings of the same size, spatial freq, position, etc as during the discrimination task.


passive_right_contrast:
Gratings of the same size, spatial freq, position, etc as during the discrimination task.


passive_white_noise:
The sound that accompanies an incorrect response during the discrimination task.


receptive_field_mapping_sparse_noise:
White squares shown on the screen with randomized positions and timing - see manuscript Methods.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">electrode_groups</span> <span class="o">=</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">electrode_groups</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">electrode_groups</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">electrode_groups</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">electrode_groups</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">location</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Probe1:
Neuropixels Phase3A opt3



Probe2:
Neuropixels Phase3A opt3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># electrode positions </span>
<span class="n">electrodes</span> <span class="o">=</span> <span class="n">nwb_file</span><span class="o">.</span><span class="n">electrodes</span>
<span class="n">electrodes</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>imp</th>
      <th>location</th>
      <th>filtering</th>
      <th>group</th>
      <th>group_name</th>
      <th>site_id</th>
      <th>site_position</th>
      <th>ccf_ap</th>
      <th>ccf_dv</th>
      <th>ccf_lr</th>
      <th>entry_point_rl</th>
      <th>entry_point_ap</th>
      <th>vertical_angle</th>
      <th>horizontal_angle</th>
      <th>axial_angle</th>
      <th>distance_advanced</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LS</td>
      <td>none</td>
      <td>Probe1 pynwb.ecephys.ElectrodeGroup at 0x14043...</td>
      <td>Probe1</td>
      <td>0</td>
      <td>[43.0, 20.0]</td>
      <td>4432.3</td>
      <td>4699.7</td>
      <td>5002.3</td>
      <td>-640</td>
      <td>1500</td>
      <td>81.400131</td>
      <td>172.959797</td>
      <td>0</td>
      <td>3800</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LS</td>
      <td>none</td>
      <td>Probe1 pynwb.ecephys.ElectrodeGroup at 0x14043...</td>
      <td>Probe1</td>
      <td>1</td>
      <td>[11.0, 20.0]</td>
      <td>4428.4</td>
      <td>4699.7</td>
      <td>4970.6</td>
      <td>-640</td>
      <td>1500</td>
      <td>81.400131</td>
      <td>172.959797</td>
      <td>0</td>
      <td>3800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LS</td>
      <td>none</td>
      <td>Probe1 pynwb.ecephys.ElectrodeGroup at 0x14043...</td>
      <td>Probe1</td>
      <td>2</td>
      <td>[59.0, 40.0]</td>
      <td>4431.3</td>
      <td>4680.0</td>
      <td>5018.6</td>
      <td>-640</td>
      <td>1500</td>
      <td>81.400131</td>
      <td>172.959797</td>
      <td>0</td>
      <td>3800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LS</td>
      <td>none</td>
      <td>Probe1 pynwb.ecephys.ElectrodeGroup at 0x14043...</td>
      <td>Probe1</td>
      <td>3</td>
      <td>[27.0, 40.0]</td>
      <td>4427.3</td>
      <td>4680.0</td>
      <td>4986.8</td>
      <td>-640</td>
      <td>1500</td>
      <td>81.400131</td>
      <td>172.959797</td>
      <td>0</td>
      <td>3800</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LS</td>
      <td>none</td>
      <td>Probe1 pynwb.ecephys.ElectrodeGroup at 0x14043...</td>
      <td>Probe1</td>
      <td>4</td>
      <td>[43.0, 60.0]</td>
      <td>4426.3</td>
      <td>4660.2</td>
      <td>5003.1</td>
      <td>-640</td>
      <td>1500</td>
      <td>81.400131</td>
      <td>172.959797</td>
      <td>0</td>
      <td>3800</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># description of each column in electrodes </span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">electrodes</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">electrodes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x:
the x coordinate of the channel location


y:
the y coordinate of the channel location


z:
the z coordinate of the channel location


imp:
the impedance of the channel


location:
the location of channel within the subject e.g. brain region


filtering:
description of hardware filtering


group:
a reference to the ElectrodeGroup this electrode is a part of


group_name:
the name of the ElectrodeGroup this electrode is a part of


site_id:
The site number, in within-probe numbering, of the channel (in practice for this dataset this always starts at zero and counts up to 383 on each probe so is equivalent to the channel number - but if switches had been used, the site number could have been different than the channel number).


site_position:
The x- and y-position of the site relative to the face of the probe (where the first column is across the face of the probe laterally and the second is the position along the length of the probe; the sites nearest the tip have second column=0).


ccf_ap:
The AP position in Allen Institute&#39;s Common Coordinate Framework.


ccf_dv:
The DV position in Allen Institute&#39;s Common Coordinate Framework.


ccf_lr:
The LR position in Allen Institute&#39;s Common Coordinate Framework.


entry_point_rl:
mediolateral position of probe entry point relative to midline (microns). Positive means right


entry_point_ap:
anteroposterior position of probe entry point relative to bregma (microns). Positive means anterior


vertical_angle:
vertical angle of probe (degrees). Zero means horizontal. Positive means pointing down


horizontal_angle:
horizontal angle of probe (degrees), after vertical rotation. Zero means anterior. Positive means counterclockwise (i.e. left).


axial_angle:
axial angle of probe (degrees). Zero means that without vertical and horizontal rotations, the probe contacts would be pointing up. Positive means &quot;counterclockwise.


distance_advanced:
How far the probe was moved forward from its entry point. (microns).
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># all electrode locations </span>
<span class="n">electrode_df</span> <span class="o">=</span> <span class="n">electrodes</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">electrode_df</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;LS&#39; &#39;root&#39; &#39;ACA&#39; &#39;MOs&#39; &#39;CA3&#39; &#39;DG&#39; &#39;SUB&#39; &#39;VISp&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stimulus_dict</span><span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;passive_beeps&#39;: passive_beeps pynwb.base.TimeSeries at 0x140437403596752
 Fields:
   comments: no comments
   conversion: 1.0
   data: &lt;HDF5 dataset &quot;data&quot;: shape (25,), type &quot;|b1&quot;&gt;
   description: Auditory tones of the same frequency as the auditory tone cue in the task
   interval: 1
   resolution: -1.0
   timestamps: &lt;HDF5 dataset &quot;timestamps&quot;: shape (25,), type &quot;&lt;f8&quot;&gt;
   timestamps_unit: seconds
   unit: n/a,
 &#39;passive_click_times&#39;: passive_click_times pynwb.base.TimeSeries at 0x140437405881680
 Fields:
   comments: no comments
   conversion: 1.0
   data: &lt;HDF5 dataset &quot;data&quot;: shape (25,), type &quot;|b1&quot;&gt;
   description: Opening of the reward valve, but with a clamp in place such that no water flows. Therefore the auditory sound of the valve is heard, but no water reward is obtained.
   interval: 1
   resolution: -1.0
   timestamps: &lt;HDF5 dataset &quot;timestamps&quot;: shape (25,), type &quot;&lt;f8&quot;&gt;
   timestamps_unit: seconds
   unit: n/a,
 &#39;passive_left_contrast&#39;: passive_left_contrast pynwb.base.TimeSeries at 0x140437405882960
 Fields:
   comments: no comments
   conversion: 1.0
   data: &lt;HDF5 dataset &quot;data&quot;: shape (150,), type &quot;&lt;f8&quot;&gt;
   description: Gratings of the same size, spatial freq, position, etc as during the discrimination task.
   interval: 1
   resolution: -1.0
   timestamps: &lt;HDF5 dataset &quot;timestamps&quot;: shape (150,), type &quot;&lt;f8&quot;&gt;
   timestamps_unit: seconds
   unit: proportion contrast,
 &#39;passive_right_contrast&#39;: passive_right_contrast pynwb.base.TimeSeries at 0x140437405883472
 Fields:
   comments: no comments
   conversion: 1.0
   data: &lt;HDF5 dataset &quot;data&quot;: shape (150,), type &quot;&lt;f8&quot;&gt;
   description: Gratings of the same size, spatial freq, position, etc as during the discrimination task.
   interval: 1
   resolution: -1.0
   timestamps: &lt;HDF5 dataset &quot;timestamps&quot;: shape (150,), type &quot;&lt;f8&quot;&gt;
   timestamps_unit: seconds
   unit: proportion contrast,
 &#39;passive_white_noise&#39;: passive_white_noise pynwb.base.TimeSeries at 0x140437405883984
 Fields:
   comments: no comments
   conversion: 1.0
   data: &lt;HDF5 dataset &quot;data&quot;: shape (25,), type &quot;|b1&quot;&gt;
   description: The sound that accompanies an incorrect response during the discrimination task.
   interval: 1
   resolution: -1.0
   timestamps: &lt;HDF5 dataset &quot;timestamps&quot;: shape (25,), type &quot;&lt;f8&quot;&gt;
   timestamps_unit: seconds
   unit: n/a,
 &#39;receptive_field_mapping_sparse_noise&#39;: receptive_field_mapping_sparse_noise pynwb.base.TimeSeries at 0x140437405933968
 Fields:
   comments: The altitude (first column) and azimuth (second column) of the square.
   conversion: 1.0
   data: &lt;HDF5 dataset &quot;data&quot;: shape (7962, 2), type &quot;&lt;f8&quot;&gt;
   description: White squares shown on the screen with randomized positions and timing - see manuscript Methods.
   interval: 1
   resolution: -1.0
   timestamps: &lt;HDF5 dataset &quot;timestamps&quot;: shape (7962,), type &quot;&lt;f8&quot;&gt;
   timestamps_unit: seconds
   unit: degrees visual angle}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># test cell</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">[</span><span class="s1">&#39;trials&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">intervals</span><span class="p">[</span><span class="s1">&#39;trials&#39;</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>start_time:
Start time of epoch, in seconds


stop_time:
Stop time of epoch, in seconds


included:
Importantly, while this variable gives inclusion criteria according to the definition of disengagement (see manuscript Methods), it does not give inclusion criteria based on the time of response, as used for most analyses in the paper.


go_cue:
The &#39;goCue&#39; is referred to as the &#39;auditory tone cue&#39; in the manuscript.


visual_stimulus_time:
Times are relative to the same time base as every other time in the dataset, not to the start of the trial.


visual_stimulus_left_contrast:
Proportion contrast. A value of 0.5 means 50% contrast. 0 is a blank screen: no change to any pixel values on that side (completely undetectable).


visual_stimulus_right_contrast:
Proportion contrast. A value of 0.5 means 50% contrast. 0 is a blank screen: no change to any pixel values on that side (completely undetectable).


response_time:
Times are relative to the same time base as every other time in the dataset, not to the start of the trial.


response_choice:
Enumerated type. The response registered at the end of the trial, which determines the feedback according to the contrast condition. Note that in a small percentage of cases (~4%, see manuscript Methods) the initial wheel turn was in the opposite direction. -1 for Right choice (i.e. correct when stimuli are on the right); +1 for left choice; 0 for Nogo choice.


feedback_time:
Times are relative to the same time base as every other time in the dataset, not to the start of the trial.


feedback_type:
Enumerated type. -1 for negative feedback (white noise burst); +1 for positive feedback (water reward delivery).


rep_num:
Trials are repeated if they are &quot;easy&quot; trials (high contrast stimuli with large difference between the two sides, or the blank screen condition) and this keeps track of how many times the current trial&#39;s condition has been repeated.
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Chapter_3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Neurodata_Without_Borders.html" title="previous page"><span class="section-number">3. </span>Neurodata Without Borders</a>
    <a class='right-next' id="next-link" href="../Chapter_4/The_Allen_SDK.html" title="next page"><span class="section-number">4. </span>The Allen SDK</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Victor Magdaleno-Garcia<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>